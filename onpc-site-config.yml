---
# Copyright (c) 2019, Patrick Petit <patrick.michel.petit@gmail.com>

#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

##
## Dictionary of netboot ISOs to install in Cobbler
##   This must be defined in onpc-site-config.yml
##
onpc_netboot_distros:
  centos-7:
    # device_or_iso_path: /var/tmp/isos/CentOS-7-x86_64-DVD-1810.iso
    url: "http://mirror.plusserver.com/centos/7.6.1810/isos/x86_64/CentOS-7-x86_64-DVD-1810.iso"
    arch: x86_64
    os_version: rhel7

##
## Dictionary of netboot profiles to register in Cobbler
##   This must be defined in onpc-site-config.yml
##
onpc_netboot_profiles:
  ##
  ## Infra profile host config
  ##   The infra profile is an aggregate of all control-plane roles
  ##
  infra:
    comment: "Infra profile host config"
    distro_name: centos-7-x86_64
    kickstart_file: centos7-osa_infra-sda.ks
    gateway: "{{ default_gateway_addr }}"
    name_servers:
      - "{{ dns_server_addr }}"
    name_servers_search:
      - "{{ onpc_infra_domain }}"
    roles: ['controller', 'network', 'haproxy', 'image']
    metadata: []
    # Boot architecture ('bios' or 'efi')
    boot_arch: bios
    #
    # Standard partitions
    #
    partitions:
      #
      # System physical volume
      #
      - partition_name: pv.01
        type: part
        size: 40000
        maxsize: 72000
        drive: sda
      - partition_name: sys_vg
        type: volgroup
        pvname: pv.01
      - partition_name: root_lv
        type: logvol
        size: 16000
        maxsize: 32000
        fstype: xfs
        mountpoint: /
        vgname: sys_vg
      - partition_name: var_log_lv
        type: logvol
        size: 1000
        maxsize: 32000
        fstype: xfs
        mountpoint: /var/log
        vgname: sys_vg
      - partition_name: tmp_lv
        type: logvol
        size: 8000
        fstype: xfs
        mountpoint: /tmp
        vgname: sys_vg
      #
      # Openstack physical volume
      #
      - partition_name: pv.02
        type: part
        size: 32000
        maxsize: 96000
        drive: sda
      - partition_name: osa_vg
        type: volgroup
        pvname: pv.02
      - partition_name: osa_lv
        type: logvol
        percent: 20
        fstype: xfs
        mountpoint: /openstack
        vgname: osa_vg
        grow: true
      - partition_name: osa_log_lv
        type: logvol
        percent: 80
        fstype: xfs
        mountpoint: /openstack/logs
        vgname: osa_vg
        grow: true
    ##
    ## Standard network interfaces
    ##
    interfaces:
      # Primary physical interface
      - interface_name: "{{ primary_interface | default('eth0') }}"
        label: primary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond0_interface }}"
        assign_mac: true
        management: true
      # Secondary physical interface
      - interface_name: "{{ secondary_interface | default('eth1') }}"
        label: secondary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond1_interface }}"
        assign_mac: true
      ##
      ## Bonds
      ##
      # bond0 interface used for management, storage and API access
      - interface_name: "{{ bond0_interface }}"
        interface_type: bond
        bonding_opts: "miimon=100 mode=1"
      # bond1 interface used for tenants networking (flat, vlan, vxlan)
      - interface_name: "{{ bond1_interface }}"
        interface_type: bonded_bridge_slave
        interface_master: "{{ external_interface }}"
        bonding_opts: "miimon=100 mode=1"
      ##
      ## VLANS
      ##
      # Container/Host management VLAN interface
      - interface_name: "{{ management_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ management_network_interface }}"
      # OpenStack services APIs VLAN interface
      - interface_name: "{{ api_vlan_interface }}"
        label: api_network_interface
        network: "{{ api_network }}"
        netmask: "{{ api_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
      # OpenStack Networking (tunnel/overlay) VLAN interface
      - interface_name: "{{ tunnel_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ tunnel_network_interface }}"
      ##
      ## Bridges
      ##
      # Container / Host management network bridge interface.
      - interface_name: "{{ management_network_interface }}"
        label: management_network_interface
        interface_type: bridge
        bridge_opts: 'STP=no'
        if_gateway: "{{ default_gateway_addr }}"
        network: "{{ management_network }}"
        netmask: "{{ management_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
      # OpenStack Networking VXLAN (tunnel/overlay) network bridge interface.
      - interface_name: "{{ tunnel_network_interface }}"
        label: tunnel_network_interface
        bridge_opts: 'STP=no'
        interface_type: bridge
        network: "{{ tunnel_network }}"
        netmask: "{{ tunnel_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
        mtu: 9000
      # OpenStack Networking (provider) network bridge interface
      - interface_name: "{{ external_interface }}"
        bridge_opts: 'STP=no'
        interface_type: bridge
  ##
  ## Compute profile host config
  ##
  compute:
    comment: "Nova compute profile config"
    distro_name: centos-7-x86_64
    kickstart_file: centos7-osa_compute-sda.ks
    gateway: "{{ default_gateway_addr }}"
    name_servers:
      - "{{ dns_server_addr }}"
    name_servers_search:
      - "{{ onpc_infra_domain }}"
    roles: ['compute']
    metadata: []
    # Boot architecture ('bios' or 'efi')
    boot_arch: bios
    ##
    ## Standard partitions
    ##
    partitions:
      #
      # System physical volume
      #
      - partition_name: pv.01
        type: part
        size: 40000
        maxsize: 72000
        drive: sda
      - partition_name: sys_vg
        type: volgroup
        pvname: pv.01
      - partition_name: root_lv
        type: logvol
        size: 16000
        maxsize: 32000
        fstype: xfs
        mountpoint: /
        vgname: sys_vg
      - partition_name: var_log_lv
        type: logvol
        size: 1000
        maxsize: 32000
        fstype: xfs
        mountpoint: /var/log
        vgname: sys_vg
      - partition_name: tmp_lv
        type: logvol
        size: 8000
        fstype: xfs
        mountpoint: /tmp
        vgname: sys_vg
      #
      # Openstack physical volume
      #
      - partition_name: pv.02
        type: part
        size: 32000
        maxsize: 96000
        drive: sda
      - partition_name: osa_vg
        type: volgroup
        pvname: pv.02
      - partition_name: osa_lv
        type: logvol
        percent: 20
        fstype: xfs
        mountpoint: /openstack
        vgname: osa_vg
        grow: true
      - partition_name: osa_lv
        type: logvol
        percent: 80
        fstype: xfs
        mountpoint: /openstack/logs
        vgname: osa_vg
        grow: true
      #
      # Compute (instances storage) physical volume
      #
      - partition_name: pv.03
        type: part
        size: 1000
        grow: true
      - partition_name: compute_vg
        type: volgroup
        pvname: pv.03
      - partition_name: compute_lv
        type: logvol
        size: 1000
        grow: true
        fstype: xfs
        mountpoint: /var/lib/nova/instances
        vgname: compute_vg
    ##
    ## Network interfaces
    ##
    interfaces:
      # Storage VLAN interface
      - interface_name: "{{ primary_interface | default('eth0') }}"
        label: primary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond0_interface }}"
        assign_mac: true
        management: true
      # Secondary physical interface
      - interface_name: "{{ secondary_interface | default('eth1') }}"
        label: secondary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond1_interface }}"
        assign_mac: true
      ##
      ## Bonds
      ##
      # bond0 interface used for management, storage and API access
      - interface_name: "{{ bond0_interface }}"
        interface_type: bond
        bonding_opts: "miimon=100 mode=1"
      # bond1 interface used for tenants networking (flat, vlan, vxlan)
      - interface_name: "{{ bond1_interface }}"
        interface_type: bonded_bridge_slave
        interface_master: "{{ external_interface }}"
        bonding_opts: "miimon=100 mode=1"
      ##
      ## VLANS
      ##
      # Container/Host management VLAN interface
      - interface_name: "{{ management_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ management_network_interface }}"
      # OpenStack Networking (tunnel/overlay) VLAN interface
      - interface_name: "{{ tunnel_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ tunnel_network_interface }}"
      # Storage network VLAN interface
      - interface_name: "{{ storage_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ storage_network_interface }}"
        assign_ip: true
        static: 1
      ##
      ## Bridges
      ##
      # Container / Host management network bridge interface.
      - interface_name: "{{ management_network_interface }}"
        label: management_network_interface
        interface_type: bridge
        bridge_opts: 'STP=no'
        if_gateway: "{{ default_gateway_addr }}"
        network: "{{ management_network }}"
        netmask: "{{ management_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
      # OpenStack Networking VXLAN (tunnel/overlay) network bridge interface.
      - interface_name: "{{ tunnel_network_interface }}"
        label: tunnel_network_interface
        bridge_opts: 'STP=no'
        interface_type: bridge
        network: "{{ tunnel_network }}"
        netmask: "{{ tunnel_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
      # OpenStack Networking (provider) network bridge interface
      - interface_name: "{{ external_interface }}"
        bridge_opts: 'STP=no'
        interface_type: bridge
      # Storage network bridge interface
      - interface_name: "{{ storage_network_interface }}"
        bridge_opts: 'STP=no'
        interface_type: bridge
        network: "{{ storage_network }}"
        netmask: "{{ storage_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
  ##
  ## Ceph role host config
  ##
  ceph:
    comment: "This is a Ceph OSD host"
    distro_name: centos-7-x86_64
    kickstart_file: centos7-osa_ceph-sda.ks
    gateway: "{{ default_gateway_addr }}"
    name_servers:
      - "{{ dns_server_addr }}"
    name_servers_search:
      - "{{ onpc_infra_domain }}"
    roles: ['ceph']
    metadata: []
    # Boot architecture ('bios' or 'efi')
    boot_arch: bios
    partitions:
      #
      # System physical volume
      #
      - partition_name: pv.01
        type: part
        size: 40000
        maxsize: 72000
        drive: sda
      - partition_name: sys_vg
        type: volgroup
        pvname: pv.01
      - partition_name: root_lv
        type: logvol
        size: 16000
        maxsize: 32000
        fstype: xfs
        mountpoint: /
        vgname: sys_vg
      - partition_name: var_log_lv
        type: logvol
        size: 1000
        maxsize: 32000
        fstype: xfs
        mountpoint: /var/log
        vgname: sys_vg
      - partition_name: tmp_lv
        type: logvol
        size: 8000
        fstype: xfs
        mountpoint: /tmp
        vgname: sys_vg
      #
      # Ceph physical volume
      #
      - partition_name: pv.05
        type: part
        size: 1000
        grow: true
      - partition_name: ceph_data_vg
        type: volgroup
        pvname: pv.05
      - partition_name: ceph_journal_vg
        type: volgroup
        pvname: pv.05
    ##
    ## Standard network interfaces
    ##    
    interfaces:
      # Storage VLAN interface
      - interface_name: "{{ primary_interface | default('eth0') }}"
        label: primary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond0_interface }}"
        assign_mac: true
        management: true
      # Secondary physical interface
      - interface_name: "{{ secondary_interface | default('eth1') }}"
        label: secondary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond1_interface }}"
        assign_mac: true
      ##
      ## Bonds
      ##
      # bond0 interface used for management, storage and API access
      - interface_name: "{{ bond0_interface }}"
        interface_type: bond
        bonding_opts: "miimon=100 mode=1"
      # bond1 interface used for tenants networking (flat, vlan, vxlan)
      - interface_name: "{{ bond1_interface }}"
        interface_type: bonded_bridge_slave
        interface_master: "{{ external_interface }}"
        bonding_opts: "miimon=100 mode=1"
      ##
      ## VLANS
      ##
      # Container/Host management VLAN interface
      - interface_name: "{{ management_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ management_network_interface }}"
      # Storage network VLAN interface
      - interface_name: "{{ storage_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ storage_network_interface }}"
        assign_ip: true
        static: 1
      ##
      ## Bridges
      ##
      # Container / Host management network bridge interface.
      - interface_name: "{{ management_network_interface }}"
        label: management_network_interface
        interface_type: bridge
        bridge_opts: 'STP=no'
        if_gateway: "{{ default_gateway_addr }}"
        network: "{{ management_network }}"
        netmask: "{{ management_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
      # Storage network bridge interface
      - interface_name: "{{ storage_network_interface }}"
        bridge_opts: 'STP=no'
        interface_type: bridge
        network: "{{ storage_network }}"
        netmask: "{{ storage_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
  ##
  ## Storage role host config
  ##
  storage:
    comment: "This is a Cinder block storage host"
    distro_name: centos-7-x86_64
    kickstart_file: centos7-osa_storage-sda.ks
    gateway: "{{ default_gateway_addr }}"
    name_servers:
      - "{{ dns_server_addr }}"
    name_servers_search:
      - "{{ onpc_infra_domain }}"
    roles: ['storage']
    metadata: []
    # Boot architecture ('bios' or 'efi')
    boot_arch: bios
    ##
    ## Standard partitions
    ##
    partitions:
      #
      # System physical volume
      #
      - partition_name: pv.01
        type: part
        size: 40000
        maxsize: 72000
        drive: sda
      - partition_name: sys_vg
        type: volgroup
        pvname: pv.01
      - partition_name: root_lv
        type: logvol
        size: 16000
        maxsize: 32000
        fstype: xfs
        mountpoint: /
        vgname: sys_vg
      - partition_name: var_log_lv
        type: logvol
        size: 1000
        maxsize: 32000
        fstype: xfs
        mountpoint: /var/log
        vgname: sys_vg
      - partition_name: tmp_lv
        type: logvol
        size: 8000
        fstype: xfs
        mountpoint: /tmp
        vgname: sys_vg
      #
      # Cinder storage physical volume
      #
      - partition_name: pv.04
        type: part
        size: 1000
        grow: true
      - partition_name: cinder_vg
        type: volgroup
        pvname: pv.04
    ##
    ## Standard network interfaces
    ##   
    interfaces:
      # Storage VLAN interface
      - interface_name: "{{ primary_interface | default('eth0') }}"
        label: primary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond0_interface }}"
        assign_mac: true
        management: true
      # Secondary physical interface
      - interface_name: "{{ secondary_interface | default('eth1') }}"
        label: secondary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond1_interface }}"
        assign_mac: true
      ##
      ## Bonds
      ##
      # bond0 interface used for management, storage and API access
      - interface_name: "{{ bond0_interface }}"
        interface_type: bond
        bonding_opts: "miimon=100 mode=1"
      # bond1 interface used for tenants networking (flat, vlan, vxlan)
      - interface_name: "{{ bond1_interface }}"
        interface_type: bonded_bridge_slave
        interface_master: "{{ external_interface }}"
        bonding_opts: "miimon=100 mode=1"
      ##
      ## VLANS
      ##
      # Container/Host management VLAN interface
      - interface_name: "{{ management_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ management_network_interface }}"
      # Storage network VLAN interface
      - interface_name: "{{ storage_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ storage_network_interface }}"
        assign_ip: true
        static: 1
      ##
      ## Bridges
      ##
      # Container / Host management network bridge interface.
      - interface_name: "{{ management_network_interface }}"
        label: management_network_interface
        interface_type: bridge
        bridge_opts: 'STP=no'
        if_gateway: "{{ default_gateway_addr }}"
        network: "{{ management_network }}"
        netmask: "{{ management_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
      # Storage network bridge interface
      - interface_name: "{{ storage_network_interface }}"
        bridge_opts: 'STP=no'
        interface_type: bridge
        network: "{{ storage_network }}"
        netmask: "{{ storage_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
  ##
  ## Swift role host config
  ##
  swift:
    comment: "This is a Swift object storage host"
    distro_name: centos-7-x86_64
    kickstart_file: centos7-osa_swift-sda.ks
    gateway: "{{ default_gateway_addr }}"
    name_servers:
      - "{{ dns_server_addr }}"
    name_servers_search:
      - "{{ onpc_infra_domain }}"
    roles: ['swift']
    metadata: []
    # Boot architecture ('bios' or 'efi')
    boot_arch: bios
    ##
    ## Standard partitions
    ##
    partitions:
      #
      # System physical volume
      #
      - partition_name: pv.01
        type: part
        size: 40000
        maxsize: 72000
        drive: sda
      - partition_name: sys_vg
        type: volgroup
        pvname: pv.01
      - partition_name: root_lv
        type: logvol
        size: 16000
        fstype: xfs
        mountpoint: /
        vgname: sys_vg
      - partition_name: var_log_lv
        type: logvol
        size: 1000
        maxsize: 32000
        fstype: xfs
        mountpoint: /var/log
        vgname: sys_vg
      - partition_name: tmp_lv
        type: logvol
        size: 8000
        fstype: xfs
        mountpoint: /tmp
        vgname: sys_vg
      #
      # Swift physical volume
      #
      - partition_name: pv.06
        type: part
        size: 1000
        grow: true
      - partition_name: swift_vg
        type: volgroup
        pvname: pv.06
      - partition_name: swift-sdb
        type: logvol
        percent: 50
        fstype: xfs
        mountpoint: /srv/node/sdb
        vgname: swift_vg
        mnt_opts: "noatime,nodiratime,nobarrier,logbufs=8"
        grow: true
      - partition_name: swift-sdc
        type: logvol
        percent: 50
        fstype: xfs
        mountpoint: /srv/node/sdc
        vgname: swift_vg
        mnt_opts: "noatime,nodiratime,nobarrier,logbufs=8"
        grow: true
    ##
    ## Standard network interfaces
    ##
    interfaces:
      # Primary physical interface
      - interface_name: "{{ primary_interface | default('eth0') }}"
        label: primary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond0_interface }}"
        assign_mac: true
        management: true
      # Secondary physical interface
      - interface_name: "{{ secondary_interface | default('eth1') }}"
        label: secondary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond1_interface }}"
        assign_mac: true

      ##
      ## Bonds
      ##
      # bond0 interface used for management, storage and API access
      - interface_name: "{{ bond0_interface }}"
        interface_type: bond
        bonding_opts: "miimon=100 mode=1"
      # bond1 interface used for tenants networking (flat, vlan, vxlan)
      - interface_name: "{{ bond1_interface }}"
        interface_type: bonded_bridge_slave
        interface_master: "{{ external_interface }}"
        bonding_opts: "miimon=100 mode=1"
      ##
      ## VLANS
      ##
      # Container/Host management VLAN interface
      - interface_name: "{{ management_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ management_network_interface }}"
      # Storage network VLAN interface
      - interface_name: "{{ storage_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ storage_network_interface }}"
        assign_ip: true
        static: 1
      ##
      ## Bridges
      ##
      # Container / Host management network bridge interface.
      - interface_name: "{{ management_network_interface }}"
        label: management_network_interface
        interface_type: bridge
        bridge_opts: 'STP=no'
        if_gateway: "{{ default_gateway_addr }}"
        network: "{{ management_network }}"
        netmask: "{{ management_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
      # Storage network bridge interface
      - interface_name: "{{ storage_network_interface }}"
        bridge_opts: 'STP=no'
        interface_type: bridge
        network: "{{ storage_network }}"
        netmask: "{{ storage_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
  ##
  ## monitoring role host config
  ##
  monitoring: &monitoring
    comment: "This is a monitoring / logging host"
    distro_name: centos-7-x86_64
    kickstart_file: centos7-default-sda.ks
    gateway: "{{ default_gateway_addr }}"
    name_servers:
      - "{{ dns_server_addr }}"
    name_servers_search:
      - "{{ onpc_infra_domain }}"
    roles: ['monitoring', 'logging']
    metadata: []
    ##
    ## Standard partitions
    ##
    partitions:
      - partition_name: biosboot
        type: part
        size: 1
        fstype: biosboot
        drive: sda
        asprimary: true
      - partition_name: boot
        type: part
        size: 1024
        fstype: ext4
        drive: sda
        mountpoint: /boot
        asprimary: true
      - partition_name: swap
        type: part
        fstype: swap
        drive: sda
        asprimary: true
      #
      # System physical volume
      #
      - partition_name: pv.01
        type: part
        size: 40000
        maxsize: 312000
        drive: sda
      - partition_name: sys_vg
        type: volgroup
        pvname: pv.01
      - partition_name: root_lv
        type: logvol
        size: 16000
        fstype: xfs
        mountpoint: /
        vgname: sys_vg
      - partition_name: var_log_lv
        type: logvol
        size: 1000
        maxsize: 32000
        fstype: xfs
        mountpoint: /var/log
        vgname: sys_vg
      - partition_name: tmp_lv
        type: logvol
        size: 8000
        fstype: xfs
        mountpoint: /tmp
        vgname: sys_vg
      - partition_name: opt_lv
        type: logvol
        size: 1000
        maxsize: 128000
        fstype: xfs
        mountpoint: /opt
        vgname: sys_vg
    #
    # Standard network interfaces
    #
    interfaces:
      # Primary physical interface
      - interface_name: "{{ primary_interface | default('eth0') }}"
        label: primary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond0_interface }}"
        assign_mac: true
        management: true
      # Secondary physical interface
      - interface_name: "{{ secondary_interface | default('eth1') }}"
        label: secondary_network_interface
        interface_type: bond_slave
        interface_master: "{{ bond1_interface }}"
        assign_mac: true
      ##
      ## Bonds
      ##
      # bond0 interface used for management, storage and API access
      - interface_name: "{{ bond0_interface }}"
        interface_type: bond
        bonding_opts: "miimon=100 mode=1"
      ##
      ## VLANS
      ##
      # Container/Host management VLAN interface
      - interface_name: "{{ management_vlan_interface }}"
        interface_type: bridge_slave
        interface_master: "{{ management_network_interface }}"
      # OpenStack services APIs VLAN interface
      - interface_name: "{{ api_vlan_interface }}"
        label: api_network_interface
        network: "{{ api_network }}"
        netmask: "{{ api_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1
      ##
      ## Bridges
      ##
      # Container / Host management network bridge interface.
      - interface_name: "{{ management_network_interface }}"
        label: management_network_interface
        interface_type: bridge
        bridge_opts: 'STP=no'
        if_gateway: "{{ default_gateway_addr }}"
        network: "{{ management_network }}"
        netmask: "{{ management_network | ipaddr('netmask') }}"
        assign_ip: true
        static: 1

  logging: *monitoring

## List of netboot systems to register in Cobbler
##   This must be defined in onpc-site-config.yml
##
onpc_netboot_systems:
  - name: infra-01
    comment: "This node is an infra node"
    profile: infra
    hostname: "{{ 'infra-01' + '.' + onpc_infra_domain }}"
    gateway: "{{ default_gateway_addr }}"
    state: present
    netboot: true
    name_servers:
      - "{{ dns_server_addr }}"
    name_servers_search:
      - "{{ onpc_infra_domain }}"
    interfaces:
      primary_network_interface:
        mac_address: "ac:1f:6b:47:3f:c8"
      secondary_network_interface:
        mac_address: "ac:1f:6b:47:3f:c9"
      api_network_interface:
        ip_address: 172.31.0.56
      management_network_interface:
        ip_address: 172.29.236.56
      tunnel_network_interface:
        ip_address: 172.29.240.56
